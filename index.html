<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anaconda Sales Intelligence</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
        .test { background: #f0f0f0; padding: 20px; margin: 20px; border: 2px solid #333; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        console.log('‚úÖ Script started');
        
        const { useState } = React;
        console.log('‚úÖ React loaded:', !!React);
        
        const App = () => {
            console.log('‚úÖ App rendering');
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(false);

            const handleUpload = async (e) => {
                console.log('üìÅ File selected');
                const file = e.target.files[0];
                if (!file) return;

                setLoading(true);
                try {
                    const text = await file.text();
                    console.log('‚úÖ File read, length:', text.length);
                    
                    Papa.parse(text, {
                        header: true,
                        complete: (results) => {
                            console.log('‚úÖ Parsed rows:', results.data.length);
                            const processed = results.data
                                .filter(row => row['Call title'] || row['Account Name'])
                                .map((row, idx) => ({
                                    id: idx,
                                    title: row['Call title'] || 'Unknown',
                                    account: row['Account Name'] || 'Unknown',
                                    rep: row['Rep Name'] || 'Unknown'
                                }));
                            
                            console.log('‚úÖ Processed calls:', processed.length);
                            setData(processed);
                            setLoading(false);
                        },
                        error: (err) => {
                            console.error('‚ùå Parse error:', err);
                            alert('Error: ' + err.message);
                            setLoading(false);
                        }
                    });
                } catch (err) {
                    console.error('‚ùå File error:', err);
                    alert('Error: ' + err.message);
                    setLoading(false);
                }
            };

            if (!data) {
                return (
                    <div style={{ padding: '40px', maxWidth: '1200px', margin: '0 auto' }}>
                        <div style={{ background: 'white', borderRadius: '8px', boxShadow: '0 2px 8px rgba(0,0,0,0.1)', padding: '40px' }}>
                            <h1 style={{ fontSize: '32px', fontWeight: 'bold', marginBottom: '10px' }}>
                                üèÜ Anaconda Sales Intelligence
                            </h1>
                            <p style={{ color: '#666', marginBottom: '30px' }}>Upload your Clari CSV file</p>
                            
                            <div style={{ border: '2px dashed #ccc', borderRadius: '8px', padding: '60px', textAlign: 'center', background: '#f9f9f9' }}>
                                <input 
                                    type="file" 
                                    accept=".csv" 
                                    onChange={handleUpload}
                                    style={{ display: 'none' }}
                                    id="upload"
                                />
                                <label htmlFor="upload" style={{ cursor: 'pointer' }}>
                                    <div style={{ fontSize: '48px', marginBottom: '20px' }}>üì§</div>
                                    <div style={{ fontSize: '20px', fontWeight: '600', marginBottom: '10px' }}>
                                        Upload CSV File
                                    </div>
                                    <div style={{ fontSize: '14px', color: '#666' }}>
                                        Click to browse or drag and drop
                                    </div>
                                </label>
                            </div>
                            
                            {loading && (
                                <div style={{ marginTop: '30px', textAlign: 'center', fontSize: '18px', color: '#666' }}>
                                    ‚è≥ Analyzing...
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            return (
                <div style={{ padding: '40px', maxWidth: '1200px', margin: '0 auto' }}>
                    <div style={{ background: 'white', borderRadius: '8px', boxShadow: '0 2px 8px rgba(0,0,0,0.1)', padding: '40px', marginBottom: '20px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                            <div>
                                <h1 style={{ fontSize: '28px', fontWeight: 'bold', marginBottom: '5px' }}>
                                    üèÜ Anaconda Sales Intelligence
                                </h1>
                                <p style={{ color: '#666' }}>{data.length} calls analyzed</p>
                            </div>
                            <button 
                                onClick={() => setData(null)}
                                style={{ padding: '10px 20px', background: '#f0f0f0', border: 'none', borderRadius: '6px', cursor: 'pointer', fontWeight: '600' }}
                            >
                                Upload New
                            </button>
                        </div>
                    </div>
                    
                    <div style={{ background: 'white', borderRadius: '8px', boxShadow: '0 2px 8px rgba(0,0,0,0.1)', padding: '40px' }}>
                        <h2 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '20px' }}>All Calls</h2>
                        {data.map((call) => (
                            <div key={call.id} style={{ border: '2px solid #ddd', borderRadius: '8px', padding: '20px', marginBottom: '15px' }}>
                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                    <div>
                                        <div style={{ fontSize: '18px', fontWeight: 'bold', marginBottom: '5px' }}>
                                            {call.account}
                                        </div>
                                        <div style={{ fontSize: '14px', color: '#666', marginBottom: '5px' }}>
                                            {call.title}
                                        </div>
                                        <div style={{ fontSize: '12px', color: '#999' }}>
                                            Rep: {call.rep}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        console.log('‚úÖ About to render');
        try {
            ReactDOM.render(<App />, document.getElementById('root'));
            console.log('‚úÖ Render complete');
        } catch (err) {
            console.error('‚ùå Render error:', err);
            document.body.innerHTML = '<div style="padding: 40px; color: red; font-size: 20px;">ERROR: ' + err.message + '</div>';
        }
    </script>
</body>
</html>